---
title: "Ames_Project"
output:
  html_document:
    df_print: paged
date: "2024-04-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
data = read.csv('ames_housing.csv')
```

```{r}
#Converting Neighborhood into a categorical predictor

data$Neighborhood = as.factor(data$Neighborhood)

#Checking the structure again

str(data)
```

```{r}
#Data Splitting for variable selection

# Random seed for reproducability

set.seed(42)

#Randomly sample 50% of the obsercation for training
train = sample(1:nrow(data), round(.5*nrow(data)))

test = -train

data_train = data[train,]
data_test = data[test,]
```

```{r}
library(leaps)
n = nrow(data_train)
#Best subset selection

mod_subsets = summary(regsubsets(SalePrice ~., data=data_train, nvmax=28))
coef_names = colnames(mod_subsets$which)

best_r2_ind = which.max(mod_subsets$adjr2)

mod_subsets$which[best_r2_ind,]
```

```{r}
subset_model = lm(SalePrice ~ LotArea + Neighborhood + OverallQual + OverallCond + YearBuilt + YearRemodAdd + BsmtFinSf1 + TotalBsmtSf + FirstFlrSf + GrLivArea + BsmtFullBath + BsmtHalfBath + FullBath + BedroomAbvGr + KitchenAbvGr + TotRmsAbvGrd + Fireplaces + GarageCars + WoodDeckSf + OpenPorchSf + ScreenPorch, data=data_train)

summary(subset_model)

```

```{r}
library(olsrr)
#Condition Number and Condition Index
round(ols_eigen_cindex(subset_model)[,1:2], 4)
```

```{r}
library(faraway)
vif(subset_model)
```

## Constant Variance  

```{r}
ols_plot_resid_fit(subset_model)
```

Does not seems to be any violation to the constant variance. Further checking with the Breush-Pagan test:\

```{r}
library(lmtest)
bptest(subset_model)
```

Fails to reject the null hypothesis. Therefore, the errors are homoscedastic. \

## Linearity

Note that the fitted vs residual plot is centered around 0, which suggests that it follows the linearity assumption.

## Normality

```{r}
ols_plot_resid_qq(subset_model)
```

```{r}
shapiro.test(resid(subset_model))
```

We fail to reject the Null hypothesis Therefore, the errors are normally distributed.
